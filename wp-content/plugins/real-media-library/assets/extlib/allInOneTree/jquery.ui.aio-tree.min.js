/*! real-media-library 03-05-2018 */

"use strict";!function(w){Function.prototype.bind=function(){}.bind||function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){}var i=[].slice,n=i.call(arguments,1),a=this,o=function(){return a.apply(this instanceof t?this:e||window,n.concat(i.call(arguments)))};return t.prototype=this.prototype,o.prototype=new t,o},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var i=t||0,n=this.length;i<n;i++)if(this[i]===e)return i;return-1}),w.mjs&&w.mjs.nestedSortable&&w.widget("mguenter.nestedSortable",w.extend({},w.mjs.nestedSortable.prototype,{_mouseDrag:function(e){if(w.mjs.nestedSortable.prototype._mouseDrag.apply(this,arguments),0<w(e.srcElement).parents(".aio-nodes").length){var t,i,n,a,o,s,r=e.clientX,l=e.clientY,d=!1;for(i=this.items.length-1;0<=i;i--)n=(t=this.items[i]).left,a=t.top,o=n+t.width,s=a+t.height,n<=r&&r<=o&&a<=l&&l<=s&&!this.currentContainer.currentItem.is(t.item)&&(e.hoverListElement=t.item,this._trigger("hoverListElement",e,this._uiHash()),d=!0);d||this._trigger("noHoverListElement",e,this._uiHash())}}})),w(document).on("click focus",'.aio-tree [disabled="disabled"]',function(e){return e.preventDefault(),w(document.activeElement).blur(),!1});var o=function(e){this._usedOpposite=null,this._usedCollapsable=!1,this._useCollapsableLocalStorage=!1,this.init(e)};o.prototype.init=function(t){!t._generatedId&&t.options.container.isCollapsable?this._doCollapsable(t):t._nodes.find("li").addClass("aio-open"),this._doResizable(t),w(document).on("click","."+t._eventClassId+" .aio-list-standard a",function(e){if("function"==typeof t.options.others.onSwitchFolder&&!w(this).hasClass("aio-disable-link"))return t.options.others.onSwitchFolder.bind(t.element)(w(this),e)})},o.prototype.sticky=function(e){if(e.options.container.isSticky){if(void 0===w.fn.hcSticky)throw"If want to use the sticky container please include the HC Sticky jQuery plugin, see http://someweblog.com/hcsticky-jquery-floating-sticky-plugin/ !";if(e.element.data("sticky"))return void e.element.hcSticky("reinit");e.element.hcSticky(e.options.container.hcStickySettings),e.element.data("sticky",!0)}},o.prototype._doTooltips=function(e){var t=e.options.container.onDoTooltips;if("function"==typeof t)t.bind(e)();else{if("function"!=typeof w.fn.tooltipster)throw"Please include tooltipster jQuery plugin (http://iamceege.github.io/tooltipster/)";var i,n,a,o;w(".aio-tooltip").each(function(){if(i=w(this).attr("data-aio-tooltip-title"),n=w(this).attr("data-aio-tooltip-text"),a=w(this).attr("data-aio-tooltip-text-disabled"),w(this).hasClass("aio-disable-link")&&(n=a),0<i.length||0<n.length){if(o=(0<i.length?'<div class="aio-tooltip-title">'+i+"</div>":"")+'<div class="aio-tooltip-text">'+n+"</p>",w(this).hasClass("tooltipstered"))try{w(this).tooltipster("destroy")}catch(e){}w(this).tooltipster(w.extend({content:o,contentAsHTML:!0,theme:"tooltipster-aio",animation:"grow",maxWidth:225},e.options.container.tooltipsterSettings))}})}},o.prototype._doCollapsable=function(s){this._usedCollapsable=!0,this._useCollapsableLocalStorage=s._localStorage&&s.options.container.collapsableLocalstorage,this._updateCollapsableNodes(s);var r=this._useCollapsableLocalStorage;w(document).on("dblclick","."+s._eventClassId+" a",function(){var e=w(this).parent().children(".aio-expander");e.is(":visible")&&e.click()}),w(document).on("click","."+s._eventClassId+" .aio-expander",function(){var e=w(this).hasClass("aio-open"),t=e?"aio-open":"aio-close",i=e?"aio-close":"aio-open",n="aio-open"==i?"1":"0";w(this).removeClass(t).addClass(i),w(this).parent().removeClass(t).addClass(i);var a=w(this).parent().children("a");if("function"==typeof s.options.others.onExpand&&s.options.others.onExpand.bind(s.element)(n,w(this).parent().children("a")),r&&s._hasAttr("data-aio-id",a)){var o=a.attr("data-aio-id");s._lsSet("expand."+o,n)}})},o.prototype._updateCollapsableNodes=function(e){if(!0!==this._usedCollapsable)return!1;var t,i,n,a,o=this._useCollapsableLocalStorage;return e._nodes.find(".aio-expander").remove(),e._nodes.find("li").each(function(){0<w(this).children("ul").children("li").length&&(i=void 0,t="aio-close",n=w(this).children("a"),o&&e._hasAttr("data-aio-id",n)&&(a=n.attr("data-aio-id"),"1"==(i=e._lsGet("expand."+a))?t="aio-open":"0"==i&&(i="aio-close")),e._defined(i)||(t="aio-"+e.options.container.collapsableDefaultStatus),w(this).addClass(t),w('<div class="aio-expander '+t+'"><i class="fa fa-minus-square-o"></i><i class="fa fa-plus-square-o"></i></div>').appendTo(w(this)))}),!0},o.prototype._doResizable=function(n){var a=n._isTouch(),r=n.options.container,e=w('<div class="aio-split-resize"></div>').prependTo(n.element.children(".aio-wrap"));(n._generatedId||!n.options.container.isResizable||!n._localStorage&&0!=r.resizeLocalStorage||!r.resizeTouch&&a.touch)&&e.addClass("aio-hide");var t=0,o=r.resizeLocalStorage&&n._localStorage;o&&(t=+n._lsGet("width"),n._defined(t)||(t=r.defaultWidth)),t<r.resizeMin&&1!==t&&(t=r.resizeMin);var l=null;if("function"==typeof r.onResizeOpposite)l=r.onResizeOpposite;else{var i=n._parseElements(r.resizeOpposite);if(e.hasClass("aio-hide"))l=function(){};else{if(!n._defined(i)||0==i.length)throw"If you want to resize the container, you need an opposite site! (options.container.resizeOpposite)";i=i.first(),this._usedOpposite=i;var s=n._idGenerate(i);l=function(e){if(0<r.resizeOppositeMin&&i.width()<r.resizeOppositeMin+1)return!1;try{n._injectStyle("opposite","#"+s+"{width: -webkit-calc(100% - "+e+"px) !important;width: -moz-calc(100% - "+e+"px) !important;width: calc(100% - "+e+"px) !important;}")}catch(e){return!1}}}}if(null===l)throw"There is no opposite handler!";var d=n.element,c="function"==typeof r.customResizeHandler?r.customResizeHandler:function(e,t){var i=e instanceof jQuery.Event,n=r.resizeMin,a=r.resizeMax,o=i?e.pageX-d.offset().left:e,s=n<=o&&o<=a;i&&e.preventDefault(),o<n-50&&(s=o=1),(s||t)&&!1!==l(o)&&(d.css("width",o+"px").toggleClass("aio-wrap-collapse",1===s),d.data("sticky")&&d.parent().css("width",o+"px"))};c=c.bind(n.element),l=l.bind(n.element);var h=!1;e.on(a.down,function(e){e.preventDefault(),w(document).on(a.move,c),h=!0}),w(document).on(a.up,function(e){var t,i;w(document).unbind(a.move,c),h&&(o&&n._lsSet("width",(t=n.element.width(),i=n.options.container,n.element.hasClass("aio-wrap-collapse")?1:(t<i&&(t=i),t>n.options.container.resizeMax?n.options.container.resizeMax:t))),"function"==typeof r.onResizeFinished&&r.onResizeFinished.bind(n.element)(n.element.width())),h=!1}),c(t),e.show().on("dblclick",function(){var e,t=250;o&&!(t=n._lsGet("rwidth"))&&(t=250),e=d.hasClass("aio-wrap-collapse")?t:1,o&&(1===e&&n._lsSet("rwidth",n._lsGet("width")||250),n._lsSet("width",e)),c(e,!0),"function"==typeof r.onResizeFinished&&r.onResizeFinished.bind(n.element)(e)})};var s=function(e){this.currentState=!0,this.currentStateText="enable",this.init(e)};s.prototype.init=function(e){this._doDraggable(e.options.movement,e),this._doDroppable(e.options.movement,e)},s.prototype.reinit=function(e){this._doDraggable(e.options.movement,e),this._doDroppable(e.options.movement,e)},s.prototype.state=function(e,t){this.currentState=t,this.currentStateText=t?"enable":"disable",this.reinit(e)},s.prototype._doDraggable=function(e,t){var i="function"==typeof e.onGetLabel?e.onGetLabel:this.draggableLabel,n="function"==typeof e.onGetHelper?e.onGetHelper:this.draggableHelper;i=i.bind(t.element),n=n.bind(t.element);var a={revert:"invalid",appendTo:"body",cursorAt:{top:0,left:0},distance:10,scrollSensitivity:50,scrollSpeed:50,refreshPositions:!0,helper:function(){var e=i(this,arguments);return n(e,this,arguments)},start:function(e){t._standardList.addClass("aio-currently-dragging"),jQuery(document.activeElement).blur()},stop:function(){t._standardList.removeClass("aio-currently-dragging")}};w.extend(a,e.draggableSettings),w(e.selector).draggable(a).draggable(this.currentStateText)},s.prototype._doDroppable=function(e,t){t._standardList.find("a").droppable(w.extend({activeClass:"ui-state-default",hoverClass:"ui-state-hover",tolerance:"pointer"},e.droppableSettings)).droppable(this.currentStateText)},s.prototype.draggableLabel=function(){return'<i class="fa fa-arrow-right" style="margin-right:5px;"></i> Move'},s.prototype.draggableHelper=function(e){return w('<div class="aio-movement-helper">'+e+"</div>")};var r=function(e){this.container=null,this.init(e)};r.prototype.init=function(e){this.container=w('<div class="aio-tree-loader"></div>').appendTo(e._toolbar)},r.prototype.fromArguments=function(e){if(0===e.length)return 0<this.container.width();var t;1===e.length?t="show"==e[0]||1==e[0]?100:"hide"==e[0]||0==e[1]?0:e[0]:2===e.length&&(t=e[0]/e[1]*100),this.change(t)},r.prototype.change=function(e){0<e?(this.container.parents(".aio-tree").addClass("loading"),this.container.css("width",e+"%")):(this.container.parents(".aio-tree").removeClass("loading"),this.container.css("width","0px"))};var l=function(e){this.itemsContainer=null,this.widget=null,this._rearrangeInvokeSimulate=null,this.init(e)};l.prototype.init=function(t){this.widget=t,this.itemsContainer=t._toolbar.find(".aio-toolbar-items"),this._iterateButtons(t,function(e){this._doCreateLink(e,t)}.bind(this))},l.prototype._doCreateLink=function(s,r){if(!(0<this.itemsContainer.find('a[data-aio-name="'+s.name+'"]').length)){var e="string"==typeof s.cssClasses?s.cssClasses:"";e+="string"==typeof s.usePredefinedFunction?" aio-predefined-"+s.usePredefinedFunction:"";var t=s.labelBack||r.options.toolbarButtons.labelBack,i="object"==typeof s.visibleInActiveFolderType&&0<s.visibleInActiveFolderType.length?s.visibleInActiveFolderType.join(";"):":",n='<a href="#" class="'+e+' aio-tooltip" style="display:none;" data-aio-predisable="'+("function"==typeof s.onPreDisable?"toolbar":"")+'" data-aio-name="'+s.name+'" data-aio-allowed="'+i+'" data-aio-name="'+s.name+'" data-aio-tooltip-title="'+(void 0!==s.toolTipTitle?s.toolTipTitle:"")+'" data-aio-tooltip-text-disabled="'+(void 0!==s.toolTipTextDisabledLink?s.toolTipTextDisabledLink:"")+'" data-aio-tooltip-text="'+(void 0!==s.toolTipText?s.toolTipText:"")+'">'+s.content+'<span class="aio-toolbar-back">'+t+"</span></a>",a=w(n).appendTo(this.itemsContainer),l="string"==typeof s.usePredefinedFunction&&"function"==typeof this["_doPredefined"+s.usePredefinedFunction],o=l&&"function"==typeof this["_doPredefinedInit"+s.usePredefinedFunction];(s.element=a).data("aio-link",s),o&&this["_doPredefinedInit"+s.usePredefinedFunction](r,w(this),s);var d=this;a.click(function(e){var t=r.active(),i=w(this).hasClass("isCancelActive"),n=0<t.length&&"AIO_NEW_TO_CREATE"==t.attr("data-aio-id"),a=!1;if("function"==typeof s.onAllowed&&!i&&!1===s.onAllowed.bind(r.element)(r,w(this)))return e.preventDefault(),!1;if(w(this).hasClass("aio-disable-link")&&!n)return e.preventDefault(),!1;if(n)if(i){r.element.removeClass("aio-prepare-create-new");var o=r._typesHandler._activeBeforeCreateForm;null!=o&&"object"==typeof o&&(a=o),r._typesHandler._activeBeforeCreateForm=null}else r.element.addClass("aio-prepare-create-new");return l&&(d["_doPredefined"+s.usePredefinedFunction](r,w(this),i,s),r._typesHandler.state(i)),"function"==typeof s.onCancel&&(i?(d.itemsContainer.add(w(this)).removeClass("isCancelActive"),s.onCancel.bind(r.element)(w(this))):d.itemsContainer.add(w(this)).addClass("isCancelActive"),r._typesHandler.state(i)),"function"!=typeof s.onClick||i||s.onClick.bind(r.element)(r,w(this)),r._defined(a)&&r.active(a),e.preventDefault(),!1})}},l.prototype._doPredefinedInitrename=function(e,t,i){w(document).on("keydown","."+e._eventClassId+" a",function(e){if(113==e.which)return i.element.click(),!1})},l.prototype._doPredefinedInitrearrange=function(t,e,i){if(t.options.container.doNotUseSaveInRearrange){var n=this;w(document).on("dragstart","."+t._eventClassId+" a[data-aio-id]",function(e){if(!w(this).parents(".aio-tree").hasClass("aio-rearrange"))return n._rearrangeInvokeSimulate=[w(this),e],t.toolbarButton("rearrange"),e.preventDefault(),!1})}},l.prototype._doPredefinedrename=function(i,e,t,n){var a,o,s=i.active(),r=s.find(".aio-node-name"),l=0<s.length&&"AIO_NEW_TO_CREATE"==s.attr("data-aio-id"),d=function(){var e=a.val(),t=l?i.options.others.onCreateFolder:n.onSave;if("function"!=typeof t)throw"If you want to use the rename/create function please define an onSave/onCreateFolder action!";t=t.bind(i.element),l?t(e,s.data("createType"),s.data("createToParent"),s):t(s.attr("data-aio-id"),e)}.bind(i);"hidden"!==r.css("visibility")?(r.css("visibility","hidden"),i.nodes(!1),this.itemsContainer.add(e).addClass("isCancelActive"),a=w('<input type="text"/>').insertAfter(s),o=w('<button class="aio-rename-submit">'+i.options.others.labelRenameSave+"</button>").insertAfter(a),a.val(r.text()).focus(),a.keypress(function(e){13==e.which&&d()}).keyup(function(e){27==e.which&&(l?i.element.find(".aio-tree-headline a.aio-cancel-create-new:visible").click():i.toolbarButton("rename"))}),o.on("click",function(e){return d(),e.preventDefault(),!1})):(r.css("visibility","visible"),i.nodes(!0),this.itemsContainer.add(e).removeClass("isCancelActive"),s.parent().children("input,button.aio-rename-submit").remove())},l.prototype._doPredefinedrearrange=function(t,e,i){if("function"!=typeof w.fn.nestedSortable)throw"Please include nestedSortable jQuery plugin (https://github.com/ilikenwf/nestedSortable)";var n=t._nodes.children("ul"),a=t.element.find(".aio-rearrange-save"),o=t.options.container.onRearrangeSave,s=t.options.container.onRearrangeCancel;if(i){if(e&&this.itemsContainer.add(e).removeClass("isCancelActive"),t._standardList.children("a").attr("disabled",!1),t._standardList.children(".aio-search").attr("disabled",!1),t.element.removeClass("aio-rearrange"),n.nestedSortable("destroy"),n.data("nestedSortable",!1),a.stop().hide(),!t.options.container.doNotUseSaveInRearrange){var r=n.data("nodesHTML");n.html(r)}t.nodes(!0),t.movement(!0),"function"==typeof s&&s.bind(t.element)(t,event)}else{if(t.element.addClass("aio-rearrange"),e&&this.itemsContainer.add(e).addClass("isCancelActive"),t._standardList.children("a").attr("disabled","disabled"),t._standardList.children(".aio-search").attr("disabled","disabled"),n.data("nodesHTML",n.html()),!t.options.container.doNotUseSaveInRearrange){if(a.length<=0){a=w('<button class="aio-rearrange-save button button-primary" style="display:none;">'+t.options.others.labelRearrangeSave+"</button>").insertAfter(t._toolbar);var l=this;a.click(function(e){return"function"==typeof o&&o.bind(t.element)(l._doPredefinedrearrangeParse(t,n),n.html(),w(this),e),e.preventDefault(),!1})}a.show()}t.movement(!1),t.nodes(!1),this._doPredefinedrearrangeActivate(n,t),n.data("nestedSortable",!0)}},l.prototype._doPredefinedrearrangeActivate=function(a,C){try{a.nestedSortable("destroy")}catch(C){}var o,s,e=this._rearrangeInvokeSimulate,t=a.scrollParent();if(t=t.is(document)?"parent":t,a.nestedSortable(w.extend({handle:"a[data-aio-href]",items:"li",listType:"ul",tolerance:"intersect",toleranceElement:"> a",helper:"clone",forceHelperSize:!1,forcePlaceholderSize:!0,doNotClear:!0,hoverListElement:function(e,t){var i=e.hoverListElement;if(!i.is(s)){s=i,clearTimeout(o);var n=i.children(".aio-expander");1!==n.length||n.hasClass("aio-open")||(o=setTimeout(function(){n.click(),setTimeout(function(){a.nestedSortable("refreshPositions")},50)},700))}},noHoverListElement:function(){clearTimeout(o),s=null},sort:function(e,t){t.helper.data("refreshPositions")||(a.nestedSortable("refreshPositions"),t.helper.data("refreshPositions",!0))},start:function(e,t){C.options.container.doNotUseSaveInRearrange&&t.item.data("oldNodesHTML",a.data("nodesHTML"))},relocate:function(e,t){C.reinit("tree");var i=w.makeArray(arguments),n=C.options.container.doNotUseSaveInRearrange,a=C.options.container.onRearrangeRelocate;if(n){if("function"!=typeof a)throw"Please define the onRearrangeRelocate function in the options!";var o,s,r,l,d=w.Deferred(),c=t.item,h=c.next(),p=c.prev(),u=!!h.is("li")&&h.children("a").attr("data-aio-id"),f=!!p.is("li")&&p.children("a").attr("data-aio-id"),v=-1,m=C._nodes.find("a[data-aio-id]"),_=c.data("oldNodesHTML"),b=c.children("a").attr("data-aio-id"),g=c.parent().parent().children("a[data-aio-id]"),y=0<g.length?g.attr("data-aio-id"):C.options.others.rootParentId;C.loader(!0),m.each(function(){if(v++,w(this).attr("data-aio-id")===b)return!1}),r=!!(o=m.eq(v+1)).is("a")&&o.attr("data-aio-id"),l=0<=v-1&&(!!(s=m.eq(v-1)).is("a")&&s.attr("data-aio-id")),a.apply(C.element,[b,y,d,f,u,l,r,i]),d.then(function(){}.bind(this),function(){C.nodesHTML(_)}.bind(this)).always(function(){C.loader(!1)}.bind(this))}},isAllowed:function(e,t,i){if(C.loader())return!1;var n="aio-restrict-hierarchical-change",a=!0;if(0<i.parents("."+n).length){var o=i.attr("id");0===e.parent().children("#"+o).length&&(a=!1)}return 0<e.parents("."+n).length&&(a=!1),a},stop:function(){e&&C.toolbarButton("rearrange"),this._rearrangeInvokeSimulate=null}.bind(this)},C.options.container.nestedSortableSettings)),e&&dispatchEvent){var i=e[0][0],n=e[1],r=n.clientX,l=n.clientY;this._dispatchEvent(i,"mousedown",this._createRearrangeEvent("mousedown",i,{clientX:r,clientY:l})),this._dispatchEvent(document,"mousemove",this._createRearrangeEvent("mousemove",document,{clientX:r+1,clientY:l+1}))}},l.prototype._dispatchEvent=function(e,t,i){return e.dispatchEvent?e.dispatchEvent(i):e.fireEvent&&e.fireEvent("on"+t,i),i},l.prototype._createRearrangeEvent=function(e,t,i){var n,a=w.extend({target:t,preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){},isPropagationStopped:function(){return!0},isImmediatePropagationStopped:function(){return!0},isDefaultPrevented:function(){return!0},bubbles:!0,cancelable:"mousemove"!=e,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},i||{});return w.isFunction(document.createEvent)?(n=document.createEvent("MouseEvents")).initMouseEvent(e,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget||document.body.parentNode):document.createEventObject&&(n=document.createEventObject(),w.extend(n,a),n.button={0:1,1:4,2:2}[n.button]||n.button),n},l.prototype._doPredefinedrearrangeParse=function(i,e){var t=e.nestedSortable("toArray",{startDepthCount:0,onGetId:function(e,t,i,n){return e.children("a").attr("data-aio-id")}});t.shift();var n=[];return"object"==typeof t&&1<t.length&&w.each(t,function(e,t){null==t.parent_id&&(t.parent_id=i.options.others.rootParentId),n.push({fid:t.id,pid:t.parent_id})}),{raw:t,parsed:n}},l.prototype._iterateButtons=function(e,t){var i=e.options.toolbarButtons.items;if("object"==typeof i||0<i.length)for(var n,a,o=0;o<i.length;o++)if(a=(n=i[o]).name,e._defined(a)){if(!1===t(n,e))break}else console.error("Toolbar button must have a name.")};var d=function(e){this._linkContainer=!1,this._animationTimeout=void 0,this._activeBeforeCreateForm=null,this.init(e)};d.prototype.init=function(t){if(this._iterateCreateTypes(t,function(e){this._doCreateLink(e,t)}.bind(this)),0!=this._linkContainer){var e='<a href="javascript:void();" class="'+t.options.createCancel.cssClasses+' aio-cancel-create-new">'+t.options.createCancel.label+"</a>",i=w(e).appendTo(this._linkContainer);i.click(function(e){return t.toolbarButton("rename"),t._nodes.find(".aio-create-new").parent().remove(),"function"==typeof t.options.others.onTypeButtonClicked&&t.options.others.onTypeButtonClicked.bind(t.element)(i,e),e.preventDefault(),!1})}},d.prototype.state=function(e){"object"==typeof this._linkContainer&&(e?this._linkContainer.removeClass("aio-disable-all"):this._linkContainer.addClass("aio-disable-all"))},d.prototype._doCreateLink=function(t,i){var e=i.element.find(".aio-tree-headline");if(!(0<(this._linkContainer=e).find('a[data-aio-name="'+t.name+'"]').length)){var n="string"==typeof t.cssClasses?t.cssClasses:"",a="object"==typeof t.visibleInActiveFolderType&&0<t.visibleInActiveFolderType.length?t.visibleInActiveFolderType.join(";"):":",o="function"==typeof t.onPreDisable?"type":"",s='<a href="#" class="'+n+' aio-tooltip" style="display:none;" data-aio-name="'+t.name+'" data-aio-predisable="'+o+'" data-aio-allowed="'+a+'" data-aio-tooltip-title="'+(void 0!==t.toolTipTitle?t.toolTipTitle:"")+'" data-aio-tooltip-text="'+(void 0!==t.toolTipText?t.toolTipText:"")+'">'+t.label+"</a>",r=w(s).appendTo(e);r.data("createType",t),r.click(function(e){return w(this).hasClass("aio-disable-link")||(this._doCreateForm(w(this),i,t),"function"==typeof i.options.others.onTypeButtonClicked&&i.options.others.onTypeButtonClicked.bind(i.element)(r,e)),e.preventDefault(),!1}.bind(this)),r.data("aio-link",t)}},d.prototype._doCreateForm=function(e,t,i){var n,a=t.active(),o=t.options.others.rootParentId;if(a.length<=0||a.parents(".aio-nodes").length<=0)n=t._nodes.children("ul");else{n=a.parent().children("ul"),o=a.attr("data-aio-id");var s=a.parent().children(".aio-expander");0<s.length?s.hasClass("aio-close")&&s.click():a.parent().addClass("aio-open")}0<a.length&&(this._activeBeforeCreateForm=a);var r=w('<li>            <a href="javascript:void(0)" class="aio-create-new" data-aio-type="" data-aio-id="AIO_NEW_TO_CREATE" data-aio-href="">        \t\t'+i.icon+'        \t\t<div class="aio-node-name"></div>        \t\t<span class="aio-cnt aio-cnt-0">0</span>        \t</a>        \t<ul></ul>        </li>').appendTo(n);r.children("a").data("createType",i),r.children("a").data("createToParent",o),t.active("AIO_NEW_TO_CREATE"),t.toolbarButton("rename")},d.prototype._iterateCreateTypes=function(e,t){var i=e.options.createTypes;if("object"==typeof i||0<i.length)for(var n,a,o=0;o<i.length;o++)a=(n=i[o]).name,e._defined(a)?t(n,e):console.error("Create type must have a name.")},d.prototype._doSwitchFolder=function(t,e,i){var n,a,o,s=e.attr("data-aio-type"),r={show:[],hide:[]};i||(i=300);var l,d="object"==typeof this._linkContainer&&this._linkContainer.find("a");(d=t._toolbar.find(".aio-toolbar-items").find("a").add(d)).each(function(){if(w(this).hasClass("aio-cancel-create-new"))return!0;0<(o=w(this).attr("data-aio-predisable")).length?("toolbar"===o?t._toolbarHandler._iterateButtons:t._typesHandler._iterateCreateTypes)(t,function(e){w(this).attr("data-aio-name")===e.name&&"function"==typeof e.onPreDisable&&(a=e.onPreDisable.bind(t.element)(e))}.bind(this)):(n=":"===(n=w(this).attr("data-aio-allowed"))?[]:n.split(";"),a=!1,0<n.length?-1<n.indexOf(s)&&(a=!0):a=!0),r[a?"show":"hide"].push(w(this))});var c=function(){if(0<r.show.length)for(var e=0;e<r.show.length;e++)(l=r.show[e].stop()).parent().hasClass("aio-toolbar-items")?l.removeClass("aio-disable-link"):r.show[e].stop().fadeIn(i).removeClass("aio-hidden");t.reinit("tooltips")}.bind(this);if(0<r.hide.length){for(var h=0;h<r.hide.length;h++)(l=r.hide[h].stop()).parent().hasClass("aio-toolbar-items")?l.addClass("aio-disable-link"):l.fadeOut(i).addClass("aio-hidden");t._defined(this._animationTimeout)&&clearTimeout(this._animationTimeout),this._animationTimeout=setTimeout(function(){c()}.bind(this),0<i?i+50:0)}else c()};var c=function(e){this._fixRestoreContent=!1,this._restoreContent=void 0,this._oldSelectedId=void 0,this._searchTimeout=void 0,this._noSearchResults=void 0,this._treeHeadline=void 0,this.init(e)};c.prototype.init=function(a){var t=this;this._noSearchResults=w("."+a._eventClassId+" .aio-no-results"),this._treeHeadline=w("."+a._eventClassId+" .aio-tree-headline"),w("."+a._eventClassId+" .aio-search input").on("propertychange input",function(e){("propertychange"===e.type&&"value"===e.originalEvent.propertyName||"propertychange"!==e.type)&&t._doSearch(a,w(this),e.target.value.toLowerCase())}),w(document).on("click","."+a._eventClassId+" .aio-search .fa-close",function(e){w(this).parent().children("input").val("").trigger("input")}),w(document).on("click","."+a._eventClassId+" .aio-search",function(e){w(e.target).is("input")||w(e.target).hasClass("fa-close")||w(this).children("input").focus()}),w(document).on("focus","."+a._eventClassId+" .aio-search input",function(e){w(this).parent().addClass("aio-search-focus")}),w(document).on("blur","."+a._eventClassId+" .aio-search input",function(e){w(this).parent().removeClass("aio-search-focus"),a._nodes.find(".aio-search-selected").removeClass("aio-search-selected"),t._fixRestoreContent=!!w(this).val()}),w(document).on("keydown","."+a._eventClassId+" .aio-search input",function(e){var t=a._nodes.find(".aio-search-selected");if((40===e.which||38===e.which)&&w(this).val()){var i,n=38===e.which?"prev":"next";return 0<t.length?(i=t.parent()[n]().children("a"),t.removeClass("aio-search-selected")):(n=38===e.which?"last":"first",i=a._nodes.find("a[data-aio-id]:"+n)),i.addClass("aio-search-selected"),0<i.length&&a.nodeToViewPort(i),e.preventDefault(),!1}if(13===e.which&&0<t.length)t[0].click();else if(27===e.which)return w(this).parent().children(".fa-close").click(),e.preventDefault(),!1;return!0})},c.prototype._doRestoreContent=function(e){if(this._restoreContent){var t=this._restoreContent.wrap("<p/>").parent(),i=e.active().attr("data-aio-id");void 0!==this._oldSelectedId&&i!=this._oldSelectedId||(i=!1),e._nodes.html(t.html()).css("min-height",""),e.element.removeClass("aio-searching"),this._restoreContent=void 0,this._oldSelectedId=void 0,this._noSearchResults.hide(),this._treeHeadline.removeClass("aio-disable-all"),e.reinit(),e.active(i,!0,!0)}},c.prototype._doFixRestoreContent=function(e,t){if(e._nodes.find(".aio-search-selected").removeClass("aio-search-selected"),this._fixRestoreContent&&this._restoreContent){var i=this;e._nodes.find("a[data-aio-id]").each(function(){i._restoreContent.find('a[data-aio-id="'+w(this).attr("data-aio-id")+'"]').replaceWith(w(this).clone().wrap("<p/>").parent().html())})}this._fixRestoreContent=!1};var e={options:{container:{isCollapsable:!0,isResizable:!0,isSticky:!0,theme:"",collapsableLocalstorage:!0,collapsableDefaultStatus:"open",defaultWidth:250,resizeOpposite:null,customResizeHandler:!(c.prototype._doSearch=function(t,i,n){var e=i.parent().children("i"),a=+n.length,o=0<n.length;e.eq(a).show(),e.eq(+!a).hide(),this._doFixRestoreContent(t,o),o?(void 0===this._restoreContent&&(this._restoreContent=w(t._nodes.html()),this._oldSelectedId=t.active().attr("data-aio-id"),t._nodes.css("min-height",t._nodes.height())),this._treeHeadline.addClass("aio-disable-all"),t._nodes.html(""),t.element.addClass("aio-searching"),clearTimeout(this._searchTimeout),this._searchTimeout=setTimeout(function(){if(i.val()){var e=[];this._restoreContent.find("a[data-aio-id] .aio-node-name").each(function(){-1<w(this).text().toLowerCase().indexOf(n)&&e.push("<li>"+w(this).parent().clone().wrap("<p/>").parent().html()+"</li>")}),t._nodes.html("<ul>"+e.slice(0,20).join("")+"</ul>"),0<e.length?this._noSearchResults.hide():this._noSearchResults.show(),t.reinit()}else this._doRestoreContent(t)}.bind(this),1<n.length?500:0)):this._doRestoreContent(t)}),onResizeOpposite:!1,onResizeFinished:!1,resizeTouch:!1,resizeLocalStorage:!0,resizeMin:250,resizeMax:800,resizeOppositeMin:200,onRearrangeCancel:!1,onRearrangeRelocate:!1,onRearrangeSave:!1,doNotUseSaveInRearrange:!1,onDoTooltips:!1,tooltipsterSettings:{},nestedSortableSettings:{},hcStickySettings:{},customLoaderHandler:!1},createTypes:[{name:"folder",icon:'<i class="fa fa-folder-open"></i><i class="fa fa-folder"></i>',visibleInActiveFolderType:!1,onPreDisable:!1,label:"New",cssClasses:!1,toolTipTitle:"",toolTipText:""}],createCancel:{label:"Cancel",cssClasses:""},toolbarButtons:{items:[{name:"rename",content:'<i class="fa fa-pencil"></i>',visibleInActiveFolderType:!1,usePredefinedFunction:"rename",toolTipTitle:"Rename",toolTipText:"Rename the current selected folder.",toolTipTextDisabledLink:"This link is disabled! Please select a folder."},{name:"rearrange",content:'<i class="fa fa-sort"></i>',cssClasses:!1,visibleInActiveFolderType:!1,onPreDisable:!1,onClick:!1,onCancel:!1,onAllowed:!1,usePredefinedFunction:"rearrange",toolTipTitle:"Rearrange",toolTipText:"Change the hierarchical order of the folders."}],labelBack:"Cancel"},movement:{customMovementHandler:!1,selector:".aio-draggable-item",onDrop:!1,onGetLabel:!1,onGetHelper:!1,draggableSettings:{},droppableSettings:{}},extendedMode:{enabled:!1,onCreateTemplate:!1},others:{rootParentId:-1,labelRenameSave:"OK",labelRearrangeSave:"Save new order",onExpand:!1,onAfterFinish:!1,onSwitchFolder:!1,onCreateFolder:!1,onTypeButtonClicked:!1}},_id:"",_eventClassId:"",_generatedId:!1,_localStorage:!1,_movementHandler:null,_typesHandler:null,_containerHandler:null,_loaderHandler:null,_toolbarHandler:null,_searchHandler:null,_standardList:null,_nodes:null,_toolbar:null,_create:function(){if(!this.element.hasClass("aio-tree"))throw"Add class .aio-tree to the item.";if(this._standardList=this.element.find(".aio-list-standard"),1!==this._standardList.length)throw"Please define one .aio-standard-list container";if(this._nodes=this.element.find(".aio-list-standard .aio-nodes"),1!==this._standardList.length)throw"Please define one .aio-list-standard > .aio-nodes container";if(this._toolbar=this.element.find(".aio-toolbar"),1!==this._toolbar.length)throw"Please define one .aio-toolbar container. If you want to hide the toolbar, create one and hide it with display:none;.";if("function"!=typeof w.fn.draggable||"function"!=typeof w.fn.sortable)throw"Please include jQuery UI with draggable and sortable support (https://jqueryui.com/).";this._eventClassId=this._guid(),this.element.addClass("aio-tree-instance "+this._eventClassId);var e=this.options.container.theme,t=[];if(this._defined(e)&&0<e.length){for(var i=e.split(" "),n=0;n<i.length;n++)t.push("aio-theme-"+i[n]);this.element.addClass(t.join(" "))}else this.element.addClass("aio-theme-default");this._idGenerate(),this._testLocalStorage(),this._containerHandler=new o(this),this._searchHandler=new c(this),this._typesHandler=new d(this),"object"==typeof this.options.movement.customMovementHandler?this._movementHandler=new this.options.customMovementHandler(this,s):this._movementHandler=new s(this),this._toolbarHandler=new l(this),"object"==typeof this.options.container.customLoaderHandler?this._loaderHandler=new this.options.container.customLoaderHandler(this):this._loaderHandler=new r(this);var a=this.active();0<a.length&&this._typesHandler._doSwitchFolder(this,a,0),this._containerHandler._doTooltips(this),setTimeout(function(){this.element.removeClass("aio-tree-fade")}.bind(this),50),"function"==typeof this.options.others.onAfterFinish&&this.options.others.onAfterFinish.bind(this.element)(),this._containerHandler.sticky(this),this.element.data("allInOneTree",!0),this._checkFolderContent(),this.element.hasClass("aio-lazy")&&this.loader(!0)},nodesJSON:function(e,t){this.nodesHTML("",t)},_onCreateTemplate:function(){},reinit:function(e){var t=0==arguments.length?["movement","tooltips","tree","rearrange"]:e.split(" ");(-1<t.indexOf("movement")&&this._movementHandler.reinit(this),-1<t.indexOf("tooltips")&&this._containerHandler._doTooltips(this),-1<t.indexOf("tree")&&this._containerHandler._updateCollapsableNodes(this),-1<t.indexOf("rearrange"))&&(this._nodes.children("ul").data("nestedSortable")&&this._toolbarHandler._doPredefinedrearrange(this,void 0,!1));this._containerHandler.sticky(this),this._checkFolderContent(),this.nodes(this._nodesLastEnabled)},movement:function(e){this._movementHandler.state(this,e)},nodeToViewPort:function(e){if(jQuery.fn.scrollParent){var t=e.scrollParent(),i=t.is(document)?w("html,body"):t,n=(t=t.is(document)?w(window):t).scrollTop(),a=this.element.find(".aio-reached-overflow"),o=parseInt(a.css("top")||0),s=n+(+a.outerHeight()+o),r=n+t.height(),l=e.offset().top+e.outerHeight(),d=l<=r;if(!(s<=l&&d)){var c=2*e.outerHeight();i.stop().animate({scrollTop:d?n-c:n+c})}}else console.warn("jQuery UI is not available (jQuery.scrollParent)")},toolbarButton:function(t){if("cancel"===t){var e=this._toolbar.find("a.isCancelActive");1===e.length&&this.toolbarButton(e.attr("data-aio-name"))}else this._toolbarHandler._iterateButtons(this,function(e){if(e.name===t)return"object"==typeof e.element&&e.element.click(),!1}.bind(this))},active:function(e,t,i){var n=this._standardList.find("a.active");if(void 0!==e){var a;if("object"==typeof(a="object"==typeof e?e:this.byId(e))&&0<a.length){if(n.removeClass("active"),a.addClass("active"),i)for(var o,s=a;0<(o=s.parents("li.aio-close")).length;)o.children(".aio-expander").click();return this._typesHandler._doSwitchFolder(this,a),"function"!=typeof this.options.others.onSwitchFolder||!0===t||this.options.others.onSwitchFolder.bind(this.element)(a,"object"==typeof n?n.attr("data-aio-id"):void 0)}return!1}return n},loader:function(){return this._loaderHandler.fromArguments(arguments)},nodes:function(e){var t="javascript:void(0)";this._nodesLastEnabled=e,this._standardList.find("a").each(function(){e?w(this).attr("href",w(this).attr("data-aio-href")).removeClass("aio-disable-link"):w(this).attr("href")!==t&&(w(this).attr("data-aio-href",w(this).attr("href")).addClass("aio-disable-link"),w(this).attr("href",t))})},_nodesLastEnabled:!0,nodesHTML:function(e,t,i){var n=this._nodes.children("ul"),a=this.active(),o=a.attr("data-aio-id");if(0===n.length)throw"There is no <ul></ul> available in the .aio-nodes container!";var s=function(){t&&(this.element.removeClass("aio-lazy"),this.loader(!1),void 0!==i?this.active(i,!0):0<a.length&&this.active(o,!0))}.bind(this);if(!e)return s(),n.html();n.data("nodesHTML",e),n.html(e),this.reinit(),s()},counts:function(e){var i;"object"==typeof e&&w.each(e,function(e,t){!1!==(i=this.byId(e))&&i.find(".aio-cnt").attr("class","aio-cnt aio-cnt-"+t).html(t)}.bind(this))},byId:function(e){return void 0!==e&&this._standardList.find('a[data-aio-id="'+e+'"]')},rename:function(e,t){var i;if(1==arguments.length)i=this.active(),t=e;else{if(2!=arguments.length)return!1;i=e instanceof jQuery?e:this.byId(e)}if(i instanceof jQuery){i.children(".aio-node-name").text(t);var n=i.children("input");return 0<n.length&&n.val(t),!0}return!1},remove:function(e){var t;if((t=1==arguments.length&&"object"==typeof e?e instanceof jQuery?e:this.byId(e):this.active())instanceof jQuery){var i=t.parent(),n=i.parent().parent(),a=!1,o=this.active(),s=o.attr("data-aio-id");return 0<o.length&&s&&(o.is(t)?a=n.is("li")?n.children("a"):"firstNode":0<n.children("ul").find('a[data-aio-id="'+s+'"]').length&&(a="firstNode")),i.remove(),"firstNode"===a&&(0<this._nodes.find("a").length?a=this._nodes.find("a:first"):0<this._standardList.find("a").length&&(a=this._standardList.find("a:first"))),a instanceof jQuery&&this.active(a),this.reinit("tree"),!0}return!1},serialize:function(){var e,t=this._nodes.children("ul"),i=this._toolbarHandler;if(0<t.length){(e=t.data("nestedSortable"))||i._doPredefinedrearrangeActivate(t,this);var n=i._doPredefinedrearrangeParse(this,t);return e||t.nestedSortable("destroy"),n}return!1},breadcrumb:function(e){var t=this.active();if(t){var i=[],n=0<!t.parents(".aio-nodes").length,a=function(e){for(;!1!==t;)0<(t=t.parent().parent().parent().children("a[data-aio-id]")).length?e():t=!1};if("objects"===e){var o=function(e){return{id:e.attr("data-aio-id"),type:e.attr("data-aio-type"),name:e.children(".aio-node-name").text(),obj:e,link:e.attr("href")}};return i.push(o(t)),n||a(function(){i.push(o(t))}),i.reverse(),i}if(i.push(t.children(".aio-node-name").text()),n||a(function(){i.push(t.children(".aio-node-name").text())}),i.reverse(),!e||"array"===e)return n||i.unshift("/"),i;if("string"===e){var s=i.join("/");return n||(s="/"+s),s}}return""},_checkFolderContent:function(){this.element.toggleClass("aio-no-folders",0===this._nodes.find("li").length)},_lsCache:void 0,_lsSet:function(e,t){var i=this._lsGet();this._objectPathSet(i,e,t),window.localStorage.setItem("AIO"+this._id,JSON.stringify(i)),this._lsCache=void 0},_lsGet:function(e){return this._lsCache||(this._lsCache=jQuery.parseJSON(window.localStorage.getItem("AIO"+this._id)||"{}")),e?this._objectPathGet(this._lsCache,e):this._lsCache},_objectPathGet:function(e,t){for(var i=(t||"").split("."),n=0;e&&n<i.length;n++)e=e[i[n]];return e},_objectPathSet:function(e,t,i){var n,a=(t||"").split(".");if(0<(n=a.length)){for(var o=0;e&&o<n-1;o++)e[a[o]]||(e[a[o]]={}),e=e[a[o]];e[a[n-1]]=i}},_testLocalStorage:function(){var e="test";try{var t=window.localStorage;t.setItem(e,e),t.removeItem(e),this._localStorage=!0}catch(e){}},_idGenerate:function(e){var t;if(e instanceof jQuery)return this._hasAttr("id",e)?e.attr("id"):(t=this._guid(),e.attr("id",t),t);var i=this.element;this._hasAttr("id")?t=i.attr("id"):(t=this._guid(),i.attr("id",t),this._generatedId=!0),this._id=t},_hasAttr:function(e,t){var i=(t instanceof jQuery?t:this.element).attr(e);return void 0!==i&&!1!==i},_parseElements:function(e,t){return"string"==typeof e?!0!==t?w(e):e:"function"==typeof e?e.bind(this.element)(jQuery):e instanceof jQuery&&!0!==t?e:void 0},_defined:function(e){return void 0!==e&&!1!==e&&null!==e},_isTouch:function(){var e="ontouchstart"in window||window.navigator.maxTouchPoints;return e?{touch:e,up:"touchend",down:"touchstart",move:"touchmove"}:{touch:e,up:"mouseup",down:"mousedown",move:"mousemove"}},_injectStyle:function(e,t){var i=this._id+"-style-"+e;return w("#"+i).remove(),w("<div />",{html:"&shy;<style>"+t+"</style>"}).attr("id",i).hide().appendTo("body")},_guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"aio-"+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}};w.widget("mguenter.allInOneTree",e)}(jQuery);